
[1;33mInitializing...[0m

Version    : 
--------------------
[1;33m footLoop Version vUNKNOWN[0m
--------------------

commit e2808d07f653ca31122c2e7ec211233ea2199875
Author: srhartono <srhartono@ucdavis.edu>
Date:   Tue Apr 25 18:20:16 2023 -0700
V2.3

---------------


Date       : 25 Apr 2023 19:31:12
Run ID     : 49e18a50-7794-41a6-92c1-a59d21c330ce
Run script : ../footLoop.pl -L 50p -Z -g output/mapping/genome/T7_init_VR_14.fa -i output/mapping/genome/T7_init_VR_14.bed -l PCB11 -n output/mapping/PBEH1-1/9_SH_T7_init_VR_14/ -r output/reads/seperated/PBEH1-1/PBEH1-1_9_SH.fastq.gz
	
[1;33mInput Parameters[0m
1. -r [0;36mRead/BAM[0m  :/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/reads/seperated/PBEH1-1/PBEH1-1_9_SH.fastq.gz
2. -g [0;36mGenome[0m    :/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.fa
3. -n [0;36mOutDir[0m    :/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14
4. -i [0;36mIndex[0m     :/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.bed
5. -L [0;36mMinRdLen[0m  :50
6. -q [0;36mMinMapQ[0m   :0
7. -Z [0;36mBismark[0m   :--bowtie2 --rdg 2,1 --rfg 2,1 --score_min L,0,-0.8

[1;33m==========>[0m
STEP 1
Preprocessing gene index file and getting sequences

	a. Transforming [1;36m /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.bed[0m into[1;36m /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed[0m
[1;33m	::: /bin/cp /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.bed /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed :::[0m
	[0;32mSUCCESS[0m: Created index file [1;32m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed[0m from [1;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.bed[0m
		[0;37mFrom geneIndexFile:[0m
		[0;37m1: gene=[1;32mT7_INIT_VR_14[0m,beg=[1;32m0[0m,end=[1;32m3322[0m,bufferLen=[1;32m0[0m,length=[1;32m3322[0m
	[0;32mSUCCESS[0m: Parsed gene coordinates from index file [1;32m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed[0m

	b. Getting fasta sequence from bed file[1;36m /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed[0m genome file[1;36m /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.fa[0m
[1;33m	::: fastaFromBed -fi /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/genome/T7_init_VR_14.fa -bed /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/T7_init_VR_14.bed_0_0_bp.bed -fo /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/T7_init_VR_14.bed_0_0_bp.bed.fa -name :::[0m
	[0;32mSUCCESS[0m: Output: geneIndexFaTemp=[0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/T7_init_VR_14.bed_0_0_bp.bed.fa[0m

	c. Parsing in gene sequence and infos from seqFile=[0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/T7_init_VR_14.bed_0_0_bp.bed.fa[0m
		[0;37mFrom fasta file:[0m
		[0;37m1:gene=T7_INIT_VR_14,length=3322[0m
	[0;32mSUCCESS[0m: Sequence has been parsed from fasta file [0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/T7_init_VR_14.bed_0_0_bp.bed.fa[0m
[1;33m<==========[0m

[1;33m==========>[0m
STEP 2
Creating bismark index and running bismark

	a. Running bismark_genome_preparation[0m --bowtie2 /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/[0m
 [1;33m ::: bismark_genome_preparation --bowtie2 /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/ > /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a//LOG.txt 2>&1 && md5sum /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/T7_init_VR_14.bed_0_0_bp.bed.fa > /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a//Bisulfite_Genome/.md5sum :::[0m

	b. Running bismark
	[0;32mSUCCESS[0m: Output already exist: [0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/PBEH1-1_9_SH_bismark_bt2.bam[0m

	[1;32mWAS NOT RUN[0m:[1;33m ::: bismark --bowtie2 --rdg 2,1 --rfg 2,1 --score_min L,0,-0.8 /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/ /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/reads/seperated/PBEH1-1/PBEH1-1_9_SH.fastq.gz :::[0m
[1;33m<==========[0m

[1;33m==========>[0m
STEP 3
Fix BAM File

	a. Fixing BAM file [0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/PBEH1-1_9_SH_bismark_bt2.bam[0m with /group/flchedingrp/mitochi/githubs/footLoop/lib/footLoop_2fixBAM.pl
	footLoop.pl subroutine fix_BAMFile::[1;32m SUCCESS!![0m fixed BAM file [1;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//PBEH1-1_9_SH_bismark_bt2.bam.fixed.gz[0m exists (MD5=[1;32mc3b330601459df4f960c10e00176e8ea[0m) and total row [1;32m(3)[0m >= total BAMFile row [1;32m(3 - 500)[0m ([1;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/PBEH1-1_9_SH_bismark_bt2.bam[0m)!
	[1;32mWAS NOT RUN[0m: [1;33m::: /group/flchedingrp/mitochi/githubs/footLoop/lib/footLoop_2fixBAM.pl -n /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14 -s /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.geneIndex/942d91072bdb04f3f1410b448a3c4e4a/T7_init_VR_14.bed_0_0_bp.bed.fa -o /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea/ :::[0m
	gzip /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//PBEH1-1_9_SH_bismark_bt2.bam.fixed	Failed to gzip /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//PBEH1-1_9_SH_bismark_bt2.bam.fixed: No such file or directory
	[1;33mmd5sum /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//PBEH1-1_9_SH_bismark_bt2.bam.fixed.gz > /group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//.PBEH1-1_9_SH_bismark_bt2.bam.fixed.gz.md5[0m
[1;33m<==========[0m

[1;33m==========>[0m
STEP 4
Parse and Filter BAM File
	a. Parsing BAM file [0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/PBEH1-1_9_SH_bismark_bt2.bam[0m and getting only high quality reads
	Example at read 1: name=[0;36m..._005848/24708594/ccs[0m	strand=[0;36m16[0m	chr/gene=[0;36mT7_INIT_VR_14[0m	pos=[0;36m6[0m	mapQ=[0;36m24[0m


	b.Logging BAM file [0;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/PBEH1-1_9_SH_bismark_bt2.bam[0m
	[1;36m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea//PBEH1-1_9_SH_bismark_bt2.bam.fixed[0m: skipped = [1;32m0[0m

Reads that passed filters:
Positive: 3
Negative: 0
Total   : 3;
	
Per Gene:
	
	(Genes that have <= 10 reads:) [1;32m
T7_INIT_VR_14 (3)

[0m
	[0;32mSUCCESS[0m: Total=3, used=3, Low Map Quality=0, Too short=0
	
	Output: [1;32m/group/flchedingrp/mitochi/githubs/footLoop/PBEH1/output/mapping/PBEH1-1/9_SH_T7_init_VR_14/.0_orig_c3b330601459df4f960c10e00176e8ea/[0m

	[1;33m<==========[0m

